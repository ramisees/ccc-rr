generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Event {
  id                   Int            @id @default(autoincrement())
  name                 String
  sportType            String         // PICKLEBALL or TENNIS
  eventDate            DateTime
  registrationDeadline DateTime
  startTime            String
  courtCount           Int            @default(2)
  maxPlayers           Int            @default(16)
  status               String         @default("REGISTRATION_OPEN") // REGISTRATION_OPEN, REGISTRATION_CLOSED, SCHEDULE_GENERATED, COMPLETED
  createdAt            DateTime       @default(now())
  updatedAt            DateTime       @updatedAt
  registrations        Registration[]
  matches              Match[]
}

model Player {
  id            Int            @id @default(autoincrement())
  name          String
  email         String?
  phone         String?
  skillLevel    String?        // BEGINNER, INTERMEDIATE, ADVANCED
  createdAt     DateTime       @default(now())
  registrations Registration[]
}

model Registration {
  id           Int      @id @default(autoincrement())
  eventId      Int
  playerId     Int
  registeredAt DateTime @default(now())
  status       String   @default("CONFIRMED") // CONFIRMED, WAITLISTED, CANCELLED
  event        Event    @relation(fields: [eventId], references: [id], onDelete: Cascade)
  player       Player   @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([eventId, playerId])
}

model Match {
  id             Int     @id @default(autoincrement())
  eventId        Int
  roundNumber    Int
  courtNumber    Int
  matchType      String  // DOUBLES or SINGLES
  team1Player1Id Int
  team1Player2Id Int?    // nullable for singles
  team2Player1Id Int
  team2Player2Id Int?    // nullable for singles
  team1Score     Int?
  team2Score     Int?
  status         String  @default("SCHEDULED") // SCHEDULED, IN_PROGRESS, COMPLETED
  event          Event   @relation(fields: [eventId], references: [id], onDelete: Cascade)
}
